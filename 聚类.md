### 目录
- [1. 什么是聚类？](#1-什么是聚类)
- [2. 聚类应用场景](#2-聚类应用场景)
- [3. 常用聚类算法](#3-常用聚类算法)
  - [3.1 K-means](#31-k-means)
  - [3.2 层次聚类](#32-层次聚类)
  - [3.3 DBSCAN](#33-dbscan)
  - [3.4 高斯混合模型（GMM）](#34-高斯混合模型gmm)
- [4. 如何选择簇数（K值）？](#4-如何选择簇数k值)
- [5. 聚类评估指标](#5-聚类评估指标)
- [6. 注意事项](#6-注意事项)

---

### 1. 什么是聚类？
聚类（Clustering）是一种**无监督学习**方法，旨在将数据集中具有相似特征的对象划分为不同的组（称为“簇”），使得：
- **同一簇内**的数据点尽可能相似；
- **不同簇之间**的数据点尽可能不同。

**核心思想**：物以类聚，人以群分。

---

### 2. 聚类应用场景
- 客户分群（如电商用户行为分析）
- 图像分割（将相似像素分组）
- 异常检测（离群点单独成簇）
- 文档分类（按主题分组）
- 生物信息学（基因表达模式分析）

---

### 3. 常用聚类算法

#### 3.1 K-means
- **原理**：通过迭代将数据划分为K个簇，最小化簇内距离平方和。
- **步骤**：
  1. 随机选择K个初始质心（中心点）。
  2. 将每个点分配到最近的质心对应的簇。
  3. 重新计算每个簇的质心（均值）。
  4. 重复步骤2-3直到收敛（质心不再变化）。
- **优点**：简单、高效，适合大数据集。
- **缺点**：
  - 需预先指定K值（簇数）。
  - **对初始质心敏感**，可能陷入局部最优。
  - 仅适用于凸形簇（如球形分布）。
  - **对异常值（Outliers）敏感**：
    1. 质心计算基于均值，异常值会显著拉偏质心位置。
    2. 异常值可能被错误分配，导致簇结构扭曲。
    3. 增大簇内误差平方和（SSE），降低聚类质量。

```python
from sklearn.cluster import KMeans
kmeans = KMeans(n_clusters=3)
kmeans.fit(data)
labels = kmeans.labels_

```

---

#### 3.2 层次聚类（Hierarchical Clustering）
- **原理**：通过逐层合并或分裂簇，形成树状结构（树状图）。
- **类型**：
  - **凝聚式（自底向上）**：每个点初始为一个簇，逐步合并最近的簇。
  - **分裂式（自顶向下）**：整个数据集为一个簇，逐步分裂。
- **优点**：无需预先指定簇数，可视化直观（树状图）。
- **缺点**：计算复杂度高（O(n³)），不适合大数据集。

---

#### 3.3 DBSCAN（基于密度的聚类）
- **原理**：通过密度将高密度区域划分为簇，低密度区域视为噪声。
- **关键参数**：
  - `eps`：邻域半径。
  - `min_samples`：核心点的最小邻域样本数。
- **步骤**：
  1. 找到核心点（周围至少`min_samples`个点在`eps`半径内）。
  2. 从核心点出发，扩展连接可达的点形成簇。
- **优点**：
  - 无需指定簇数。
  - 可识别任意形状的簇和噪声。
- **缺点**：对参数敏感，高维数据效果差。

---

#### 3.4 高斯混合模型（GMM）
- **原理**：假设数据由多个高斯分布生成，通过EM算法估计参数。
- **优点**：可生成概率型聚类结果（软聚类）。
- **缺点**：计算复杂，可能过拟合。

---

### 4. 如何选择簇数（K值）？
- **肘部法（Elbow Method）**：绘制不同K值的簇内误差平方和（SSE），选择拐点。
- **轮廓系数（Silhouette Score）**：衡量簇内紧密度和簇间分离度，值越接近1越好。
- **领域知识**：结合业务需求确定合理分组数。

---

### 5. 聚类评估指标
- **内部指标**（无需真实标签）：
  - 轮廓系数（Silhouette Score）
  - Calinski-Harabasz指数（簇间方差/簇内方差）
- **外部指标**（需真实标签）：
  - 调整兰德指数（Adjusted Rand Index）
  - 归一化互信息（NMI）

---

### 6. 注意事项
- **数据标准化**：聚类对尺度敏感，需标准化（如Z-score）。
- **处理噪声和离群点**：如使用DBSCAN。
- **高维数据**：考虑降维（如PCA）后再聚类。
- **非凸形状簇**：避免使用K-means，选择DBSCAN或谱聚类。